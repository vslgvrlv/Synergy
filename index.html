<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–°–∏—Å—Ç–µ–º–∞ –∑–∞–∫–∞–∑–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤</title>
  <style>
    /* Design System Variables */
    :root {
  /* Primitive Color Tokens */
  --color-white: rgba(255, 255, 255, 1);
  --color-black: rgba(0, 0, 0, 1);
  --color-cream-50: rgba(252, 252, 249, 1);
  --color-cream-100: rgba(255, 255, 253, 1);
  --color-gray-200: rgba(245, 245, 245, 1);
  --color-gray-300: rgba(167, 169, 169, 1);
  --color-gray-400: rgba(119, 124, 124, 1);
  --color-slate-500: rgba(98, 108, 113, 1);
  --color-brown-600: rgba(94, 82, 64, 1);
  --color-charcoal-700: rgba(31, 33, 33, 1);
  --color-charcoal-800: rgba(38, 40, 40, 1);
  --color-slate-900: rgba(19, 52, 59, 1);
  --color-teal-300: rgba(50, 184, 198, 1);
  --color-teal-400: rgba(45, 166, 178, 1);
  --color-teal-500: rgba(33, 128, 141, 1);
  --color-teal-600: rgba(29, 116, 128, 1);
  --color-teal-700: rgba(26, 104, 115, 1);
  --color-teal-800: rgba(41, 150, 161, 1);
  --color-red-400: rgba(255, 84, 89, 1);
  --color-red-500: rgba(192, 21, 47, 1);
  --color-orange-400: rgba(230, 129, 97, 1);
  --color-orange-500: rgba(168, 75, 47, 1);

  /* RGB versions for opacity control */
  --color-brown-600-rgb: 94, 82, 64;
  --color-teal-500-rgb: 33, 128, 141;
  --color-slate-900-rgb: 19, 52, 59;
  --color-slate-500-rgb: 98, 108, 113;
  --color-red-500-rgb: 192, 21, 47;
  --color-red-400-rgb: 255, 84, 89;
  --color-orange-500-rgb: 168, 75, 47;
  --color-orange-400-rgb: 230, 129, 97;

  /* Background color tokens (Light Mode) */
  --color-bg-1: rgba(59, 130, 246, 0.08);
  --color-bg-2: rgba(245, 158, 11, 0.08);
  --color-bg-3: rgba(34, 197, 94, 0.08);
  --color-bg-4: rgba(239, 68, 68, 0.08);
  --color-bg-5: rgba(147, 51, 234, 0.08);
  --color-bg-6: rgba(249, 115, 22, 0.08);
  --color-bg-7: rgba(236, 72, 153, 0.08);
  --color-bg-8: rgba(6, 182, 212, 0.08);

  /* Semantic Color Tokens (Light Mode) */
  --color-background: var(--color-cream-50);
  --color-surface: var(--color-cream-100);
  --color-text: var(--color-slate-900);
  --color-text-secondary: var(--color-slate-500);
  --color-primary: var(--color-teal-500);
  --color-primary-hover: var(--color-teal-600);
  --color-primary-active: var(--color-teal-700);
  --color-secondary: rgba(var(--color-brown-600-rgb), 0.12);
  --color-secondary-hover: rgba(var(--color-brown-600-rgb), 0.2);
  --color-secondary-active: rgba(var(--color-brown-600-rgb), 0.25);
  --color-border: rgba(var(--color-brown-600-rgb), 0.2);
  --color-btn-primary-text: var(--color-cream-50);
  --color-card-border: rgba(var(--color-brown-600-rgb), 0.12);
  --color-card-border-inner: rgba(var(--color-brown-600-rgb), 0.12);
  --color-error: var(--color-red-500);
  --color-success: var(--color-teal-500);
  --color-warning: var(--color-orange-500);
  --color-info: var(--color-slate-500);
  --color-focus-ring: rgba(var(--color-teal-500-rgb), 0.4);
  --color-select-caret: rgba(var(--color-slate-900-rgb), 0.8);

  /* Common style patterns */
  --focus-ring: 0 0 0 3px var(--color-focus-ring);
  --focus-outline: 2px solid var(--color-primary);
  --status-bg-opacity: 0.15;
  --status-border-opacity: 0.25;

  /* RGB versions for opacity control */
  --color-success-rgb: 33, 128, 141;
  --color-error-rgb: 192, 21, 47;
  --color-warning-rgb: 168, 75, 47;
  --color-info-rgb: 98, 108, 113;

  /* Typography */
  --font-family-base: "FKGroteskNeue", "Geist", "Inter", -apple-system,
    BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
  --font-family-mono: "Berkeley Mono", ui-monospace, SFMono-Regular, Menlo,
    Monaco, Consolas, monospace;
  --font-size-xs: 11px;
  --font-size-sm: 12px;
  --font-size-base: 14px;
  --font-size-md: 14px;
  --font-size-lg: 16px;
  --font-size-xl: 18px;
  --font-size-2xl: 20px;
  --font-size-3xl: 24px;
  --font-size-4xl: 30px;
  --font-weight-normal: 400;
  --font-weight-medium: 500;
  --font-weight-semibold: 550;
  --font-weight-bold: 600;
  --line-height-tight: 1.2;
  --line-height-normal: 1.5;
  --letter-spacing-tight: -0.01em;

  /* Spacing */
  --space-0: 0;
  --space-1: 1px;
  --space-2: 2px;
  --space-4: 4px;
  --space-6: 6px;
  --space-8: 8px;
  --space-10: 10px;
  --space-12: 12px;
  --space-16: 16px;
  --space-20: 20px;
  --space-24: 24px;
  --space-32: 32px;

  /* Border Radius */
  --radius-sm: 6px;
  --radius-base: 8px;
  --radius-md: 10px;
  --radius-lg: 12px;
  --radius-full: 9999px;

  /* Shadows */
  --shadow-xs: 0 1px 2px rgba(0, 0, 0, 0.02);
  --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.04), 0 1px 2px rgba(0, 0, 0, 0.02);
  --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.04),
    0 2px 4px -1px rgba(0, 0, 0, 0.02);
  --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.04),
    0 4px 6px -2px rgba(0, 0, 0, 0.02);
  --shadow-inset-sm: inset 0 1px 0 rgba(255, 255, 255, 0.15),
    inset 0 -1px 0 rgba(0, 0, 0, 0.03);

  /* Animation */
  --duration-fast: 150ms;
  --duration-normal: 250ms;
  --ease-standard: cubic-bezier(0.16, 1, 0.3, 1);

  /* Layout */
  --container-sm: 640px;
  --container-md: 768px;
  --container-lg: 1024px;
  --container-xl: 1280px;
}

/* Dark mode colors */
@media (prefers-color-scheme: dark) {
  :root {
    /* RGB versions for opacity control (Dark Mode) */
    --color-gray-400-rgb: 119, 124, 124;
    --color-teal-300-rgb: 50, 184, 198;
    --color-gray-300-rgb: 167, 169, 169;
    --color-gray-200-rgb: 245, 245, 245;

    /* Background color tokens (Dark Mode) */
    --color-bg-1: rgba(29, 78, 216, 0.15);
    --color-bg-2: rgba(180, 83, 9, 0.15);
    --color-bg-3: rgba(21, 128, 61, 0.15);
    --color-bg-4: rgba(185, 28, 28, 0.15);
    --color-bg-5: rgba(107, 33, 168, 0.15);
    --color-bg-6: rgba(194, 65, 12, 0.15);
    --color-bg-7: rgba(190, 24, 93, 0.15);
    --color-bg-8: rgba(8, 145, 178, 0.15);

    /* Semantic Color Tokens (Dark Mode) */
    --color-background: var(--color-charcoal-700);
    --color-surface: var(--color-charcoal-800);
    --color-text: var(--color-gray-200);
    --color-text-secondary: rgba(var(--color-gray-300-rgb), 0.7);
    --color-primary: var(--color-teal-300);
    --color-primary-hover: var(--color-teal-400);
    --color-primary-active: var(--color-teal-800);
    --color-secondary: rgba(var(--color-gray-400-rgb), 0.15);
    --color-secondary-hover: rgba(var(--color-gray-400-rgb), 0.25);
    --color-secondary-active: rgba(var(--color-gray-400-rgb), 0.3);
    --color-border: rgba(var(--color-gray-400-rgb), 0.3);
    --color-error: var(--color-red-400);
    --color-success: var(--color-teal-300);
    --color-warning: var(--color-orange-400);
    --color-info: var(--color-gray-300);
    --color-focus-ring: rgba(var(--color-teal-300-rgb), 0.4);
    --color-btn-primary-text: var(--color-slate-900);
    --color-card-border: rgba(var(--color-gray-400-rgb), 0.2);
    --color-card-border-inner: rgba(var(--color-gray-400-rgb), 0.15);
    --shadow-inset-sm: inset 0 1px 0 rgba(255, 255, 255, 0.1),
      inset 0 -1px 0 rgba(0, 0, 0, 0.15);
    --color-select-caret: rgba(var(--color-gray-200-rgb), 0.8);

    /* RGB versions for dark mode */
    --color-success-rgb: var(--color-teal-300-rgb);
    --color-error-rgb: var(--color-red-400-rgb);
    --color-warning-rgb: var(--color-orange-400-rgb);
    --color-info-rgb: var(--color-gray-300-rgb);
  }
}

@font-face {
  font-family: 'FKGroteskNeue';
  src: url('https://r2cdn.perplexity.ai/fonts/FKGroteskNeue.woff2')
    format('woff2');
}

/* Base styles */
html {
  font-size: var(--font-size-base);
  font-family: var(--font-family-base);
  line-height: var(--line-height-normal);
  color: var(--color-text);
  background-color: var(--color-background);
  -webkit-font-smoothing: antialiased;
  box-sizing: border-box;
}

body {
  margin: 0;
  padding: 0;
}

*,
*::before,
*::after {
  box-sizing: inherit;
}

/* App Container */
.app-container {
  max-width: 800px;
  margin: 0 auto;
  padding: var(--space-24);
  min-height: 100vh;
}

/* Header */
.app-header {
  margin-bottom: var(--space-32);
}

.app-title {
  font-size: var(--font-size-3xl);
  font-weight: var(--font-weight-semibold);
  color: var(--color-text);
  margin: 0 0 var(--space-24) 0;
  letter-spacing: var(--letter-spacing-tight);
}

/* Tabs */
.tabs {
  display: flex;
  gap: var(--space-8);
  border-bottom: 1px solid var(--color-border);
  margin-bottom: var(--space-24);
}

.tab {
  padding: var(--space-12) var(--space-24);
  background: none;
  border: none;
  border-bottom: 2px solid transparent;
  font-size: var(--font-size-lg);
  font-weight: var(--font-weight-medium);
  color: var(--color-text-secondary);
  cursor: pointer;
  transition: all var(--duration-fast) var(--ease-standard);
}

.tab:hover {
  color: var(--color-text);
}

.tab.active {
  color: var(--color-primary);
  border-bottom-color: var(--color-primary);
}

/* View Container */
.view {
  display: none;
}

.view.active {
  display: block;
}

/* Section */
.form-section {
  margin-bottom: var(--space-32);
}

.section-label {
  display: block;
  font-size: var(--font-size-base);
  font-weight: var(--font-weight-semibold);
  color: var(--color-text);
  margin-bottom: var(--space-12);
}

/* Button Group */
.button-group {
  display: flex;
  gap: var(--space-8);
  flex-wrap: wrap;
}

.option-button {
  flex: 1;
  min-width: 100px;
  padding: var(--space-12) var(--space-16);
  border: 1px solid var(--color-border);
  background: var(--color-surface);
  border-radius: var(--radius-base);
  font-size: var(--font-size-base);
  font-weight: var(--font-weight-medium);
  color: var(--color-text);
  cursor: pointer;
  transition: all var(--duration-fast) var(--ease-standard);
}

.option-button:hover {
  background: var(--color-secondary);
  border-color: var(--color-primary);
}

.option-button.selected {
  background: var(--color-primary);
  border-color: var(--color-primary);
  color: var(--color-btn-primary-text);
}

.option-button:focus-visible {
  outline: var(--focus-outline);
  outline-offset: 2px;
}

/* Validity Info */
.validity-info {
  margin-top: var(--space-8);
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
}

/* Input Group */
.input-group {
  margin-top: var(--space-16);
}

.input-label {
  display: block;
  font-size: var(--font-size-base);
  font-weight: var(--font-weight-semibold);
  color: var(--color-text);
  margin-bottom: var(--space-8);
}

.input-field {
  width: 100%;
  padding: var(--space-12) var(--space-16);
  font-size: var(--font-size-base);
  font-family: var(--font-family-base);
  color: var(--color-text);
  background-color: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-base);
  transition: border-color var(--duration-fast) var(--ease-standard);
}

.input-field:focus {
  outline: var(--focus-outline);
  border-color: var(--color-primary);
}

.input-field.error {
  border-color: var(--color-error);
}

.input-error {
  display: block;
  margin-top: var(--space-6);
  font-size: var(--font-size-sm);
  color: var(--color-error);
}

/* Submit Button */
.submit-button {
  width: 100%;
  padding: var(--space-16);
  margin-top: var(--space-24);
  background: var(--color-primary);
  color: var(--color-btn-primary-text);
  border: none;
  border-radius: var(--radius-base);
  font-size: var(--font-size-lg);
  font-weight: var(--font-weight-semibold);
  cursor: pointer;
  transition: all var(--duration-normal) var(--ease-standard);
}

.submit-button:hover:not(:disabled) {
  background: var(--color-primary-hover);
}

.submit-button:active:not(:disabled) {
  background: var(--color-primary-active);
}

.submit-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* Confirmation Card */
.confirmation-card {
  background: var(--color-surface);
  border: 1px solid var(--color-card-border);
  border-radius: var(--radius-lg);
  padding: var(--space-32);
  box-shadow: var(--shadow-md);
}

.confirmation-header {
  text-align: center;
  margin-bottom: var(--space-24);
}

.success-icon {
  font-size: 48px;
  color: var(--color-success);
  margin-bottom: var(--space-12);
}

.confirmation-title {
  font-size: var(--font-size-2xl);
  font-weight: var(--font-weight-semibold);
  color: var(--color-success);
  margin: 0 0 var(--space-8) 0;
}

.pass-number {
  font-size: var(--font-size-lg);
  color: var(--color-text-secondary);
  font-family: var(--font-family-mono);
}

.confirmation-details {
  margin: var(--space-24) 0;
}

.detail-row {
  display: flex;
  padding: var(--space-12) 0;
  border-bottom: 1px solid var(--color-card-border-inner);
}

.detail-row:last-child {
  border-bottom: none;
}

.detail-label {
  flex: 0 0 140px;
  font-weight: var(--font-weight-medium);
  color: var(--color-text-secondary);
}

.detail-value {
  flex: 1;
  color: var(--color-text);
  font-weight: var(--font-weight-medium);
}

.confirmation-actions {
  display: flex;
  gap: var(--space-12);
  margin-top: var(--space-24);
}

.action-button {
  flex: 1;
  padding: var(--space-12) var(--space-16);
  border-radius: var(--radius-base);
  font-size: var(--font-size-base);
  font-weight: var(--font-weight-medium);
  cursor: pointer;
  transition: all var(--duration-fast) var(--ease-standard);
}

.action-button-primary {
  background: var(--color-primary);
  color: var(--color-btn-primary-text);
  border: none;
}

.action-button-primary:hover {
  background: var(--color-primary-hover);
}

.action-button-secondary {
  background: var(--color-secondary);
  color: var(--color-text);
  border: 1px solid var(--color-border);
}

.action-button-secondary:hover {
  background: var(--color-secondary-hover);
}

/* Archive */
.archive-empty {
  text-align: center;
  padding: var(--space-32);
  color: var(--color-text-secondary);
  font-size: var(--font-size-lg);
}

.archive-list {
  display: flex;
  flex-direction: column;
  gap: var(--space-16);
}

.archive-item {
  background: var(--color-surface);
  border: 1px solid var(--color-card-border);
  border-radius: var(--radius-lg);
  padding: var(--space-20);
  transition: box-shadow var(--duration-fast) var(--ease-standard);
}

.archive-item:hover {
  box-shadow: var(--shadow-md);
}

.archive-item-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: var(--space-16);
}

.archive-pass-number {
  font-size: var(--font-size-lg);
  font-weight: var(--font-weight-semibold);
  font-family: var(--font-family-mono);
  color: var(--color-text);
}

.delete-button {
  padding: var(--space-8);
  background: var(--color-secondary);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-sm);
  color: var(--color-text);
  cursor: pointer;
  transition: all var(--duration-fast) var(--ease-standard);
  font-size: var(--font-size-base);
}

.delete-button:hover {
  background: rgba(var(--color-error-rgb), 0.1);
  color: var(--color-error);
  border-color: var(--color-error);
}

.archive-item-details {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: var(--space-12);
}

.archive-detail {
  font-size: var(--font-size-sm);
}

.archive-detail-label {
  color: var(--color-text-secondary);
  display: block;
  margin-bottom: var(--space-4);
}

.archive-detail-value {
  color: var(--color-text);
  font-weight: var(--font-weight-medium);
}

/* Responsive */
@media (max-width: 640px) {
  .app-container {
    padding: var(--space-16);
  }

  .app-title {
    font-size: var(--font-size-2xl);
  }

  .tab {
    padding: var(--space-10) var(--space-16);
    font-size: var(--font-size-base);
  }

  .option-button {
    min-width: 80px;
    font-size: var(--font-size-sm);
  }

  .confirmation-card {
    padding: var(--space-24);
  }

  .confirmation-actions {
    flex-direction: column;
  }

  .detail-label {
    flex: 0 0 100px;
  }

  .archive-item-details {
    grid-template-columns: 1fr;
  }
}
  </style>
</head>
<body>
  <div class="app-container">
    <header class="app-header">
      <h1 class="app-title">–°–∏—Å—Ç–µ–º–∞ –∑–∞–∫–∞–∑–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤</h1>
      <div class="tabs">
        <button class="tab active" data-view="order">–ó–∞–∫–∞–∑–∞—Ç—å –ø—Ä–æ–ø—É—Å–∫</button>
        <button class="tab" data-view="archive">–ê—Ä—Ö–∏–≤</button>
      </div>
    </header>

    <!-- Order Pass View -->
    <div id="order-view" class="view active">
      <div id="order-form">
        <!-- Section 1: Reason -->
        <div class="form-section">
          <label class="section-label">–ü—Ä–∏—á–∏–Ω–∞ –ø–æ—Å–µ—â–µ–Ω–∏—è</label>
          <div class="button-group">
            <button class="option-button" data-type="reason" data-value="–ì–æ—Å—Ç—å">–ì–æ—Å—Ç—å</button>
            <button class="option-button" data-type="reason" data-value="–î–æ—Å—Ç–∞–≤–∫–∞">–î–æ—Å—Ç–∞–≤–∫–∞</button>
            <button class="option-button" data-type="reason" data-value="–¢–∞–∫—Å–∏">–¢–∞–∫—Å–∏</button>
          </div>
        </div>

        <!-- Section 2: Vehicle Type -->
        <div class="form-section">
          <label class="section-label">–¢–∏–ø —Å—Ä–µ–¥—Å—Ç–≤–∞</label>
          <div class="button-group">
            <button class="option-button" data-type="vehicle" data-value="–õ–µ–≥–∫–æ–≤–æ–π">–õ–µ–≥–∫–æ–≤–æ–π</button>
            <button class="option-button" data-type="vehicle" data-value="–ì—Ä—É–∑–æ–≤–æ–π">–ì—Ä—É–∑–æ–≤–æ–π</button>
            <button class="option-button" data-type="vehicle" data-value="–ü–µ—à–µ—Ö–æ–¥">–ü–µ—à–µ—Ö–æ–¥</button>
          </div>
        </div>

        <!-- Section 3: Validity Period -->
        <div class="form-section">
          <label class="section-label">–ü–µ—Ä–∏–æ–¥ –¥–µ–π—Å—Ç–≤–∏—è</label>
          <div class="button-group">
            <button class="option-button" data-type="validity" data-value="today">–°–µ–≥–æ–¥–Ω—è</button>
            <button class="option-button" data-type="validity" data-value="tomorrow">–ó–∞–≤—Ç—Ä–∞</button>
          </div>
          <div class="validity-info" id="validity-info"></div>
        </div>

        <!-- Section 4: Input -->
        <div class="form-section">
          <div class="input-group">
            <label class="input-label" id="input-label">–ù–æ–º–µ—Ä –ø—Ä–æ–ø—É—Å–∫–∞</label>
            <input 
              type="text" 
              class="input-field" 
              id="identifier-input"
              placeholder="–ê–ê123–ê–ê01"
            />
            <span class="input-error" id="input-error"></span>
          </div>
        </div>

        <!-- Submit Button -->
        <button class="submit-button" id="submit-button" disabled>–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–ø—É—Å–∫</button>
      </div>

      <!-- Confirmation Screen -->
      <div id="confirmation-screen" style="display: none;">
        <div class="confirmation-card">
          <div class="confirmation-header">
            <div class="success-icon">‚úì</div>
            <h2 class="confirmation-title">–ü—Ä–æ–ø—É—Å–∫ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!</h2>
            <div class="pass-number" id="confirmation-pass-number"></div>
          </div>
          <div class="confirmation-details" id="confirmation-details"></div>
          <div class="confirmation-actions">
            <button class="action-button action-button-primary" id="new-pass-button">–ù–æ–≤—ã–π –ø—Ä–æ–ø—É—Å–∫</button>
            <button class="action-button action-button-secondary" id="to-archive-button">–ö –∞—Ä—Ö–∏–≤—É</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Archive View -->
    <div id="archive-view" class="view">
      <div id="archive-empty" class="archive-empty">
        –ê—Ä—Ö–∏–≤ –ø—É—Å—Ç
      </div>
      <div id="archive-list" class="archive-list" style="display: none;"></div>
    </div>
  </div>

  <script>
    // Application State
    const state = {
      currentView: 'order',
      selectedReason: null,
      selectedVehicle: null,
      selectedValidity: null,
      inputValue: '',
      passes: [],
      showingConfirmation: false,
      lastCreatedPass: null
    };

    // DOM Elements
    const elements = {
      tabs: document.querySelectorAll('.tab'),
      orderView: document.getElementById('order-view'),
      archiveView: document.getElementById('archive-view'),
      orderForm: document.getElementById('order-form'),
      confirmationScreen: document.getElementById('confirmation-screen'),
      optionButtons: document.querySelectorAll('.option-button'),
      inputLabel: document.getElementById('input-label'),
      identifierInput: document.getElementById('identifier-input'),
      inputError: document.getElementById('input-error'),
      validityInfo: document.getElementById('validity-info'),
      submitButton: document.getElementById('submit-button'),
      confirmationPassNumber: document.getElementById('confirmation-pass-number'),
      confirmationDetails: document.getElementById('confirmation-details'),
      newPassButton: document.getElementById('new-pass-button'),
      toArchiveButton: document.getElementById('to-archive-button'),
      archiveEmpty: document.getElementById('archive-empty'),
      archiveList: document.getElementById('archive-list')
    };

    // Validation
    const vehiclePlateRegex = /^[–ê-–Ø–Å]{2}\d{3}[–ê-–Ø–Å]{2}\d{2}$/;
    const minNameLength = 5;

    function validateInput() {
      const value = state.inputValue.trim();
      
      if (!value) {
        return { valid: false, error: '' };
      }

      if (state.selectedVehicle === '–ü–µ—à–µ—Ö–æ–¥') {
        if (value.length < minNameLength) {
          return { valid: false, error: '–ú–∏–Ω–∏–º—É–º 5 —Å–∏–º–≤–æ–ª–æ–≤' };
        }
        return { valid: true, error: '' };
      } else {
        if (!vehiclePlateRegex.test(value)) {
          return { valid: false, error: '–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –Ω–æ–º–µ—Ä–∞ (–ê–ê123–ê–ê01)' };
        }
        return { valid: true, error: '' };
      }
    }

    function updateInputField() {
      if (state.selectedVehicle === '–ü–µ—à–µ—Ö–æ–¥') {
        elements.inputLabel.textContent = '–§–ò–û';
        elements.identifierInput.placeholder = '–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω–æ–≤–∏—á';
      } else {
        elements.inputLabel.textContent = '–ù–æ–º–µ—Ä –ø—Ä–æ–ø—É—Å–∫–∞';
        elements.identifierInput.placeholder = '–ê–ê123–ê–ê01';
      }
      elements.identifierInput.value = state.inputValue;
      validateForm();
    }

    function updateValidityInfo() {
      if (state.selectedValidity === 'today') {
        elements.validityInfo.textContent = '–î–æ 23:59';
      } else if (state.selectedValidity === 'tomorrow') {
        elements.validityInfo.textContent = '00:00 - 23:59';
      } else {
        elements.validityInfo.textContent = '';
      }
    }

    function validateForm() {
      const validation = validateInput();
      const isFormValid = 
        state.selectedReason &&
        state.selectedVehicle &&
        state.selectedValidity &&
        validation.valid;

      elements.submitButton.disabled = !isFormValid;

      // Show error if input has been touched
      if (state.inputValue && !validation.valid) {
        elements.inputError.textContent = validation.error;
        elements.identifierInput.classList.add('error');
      } else {
        elements.inputError.textContent = '';
        elements.identifierInput.classList.remove('error');
      }
    }

    function generatePassId() {
      const now = new Date();
      const timestamp = now.getFullYear() +
        String(now.getMonth() + 1).padStart(2, '0') +
        String(now.getDate()).padStart(2, '0') +
        String(now.getHours()).padStart(2, '0') +
        String(now.getMinutes()).padStart(2, '0') +
        String(now.getSeconds()).padStart(2, '0');
      return `PASS-${timestamp}`;
    }

    function getValidityString() {
      if (state.selectedValidity === 'today') {
        return '–°–µ–≥–æ–¥–Ω—è –¥–æ 23:59';
      } else {
        return '–ó–∞–≤—Ç—Ä–∞ 00:00 - 23:59';
      }
    }

    function createPass() {
      const pass = {
        id: generatePassId(),
        reason: state.selectedReason,
        vehicleType: state.selectedVehicle,
        validity: state.selectedValidity,
        identifier: state.inputValue.trim(),
        createdAt: new Date().toISOString(),
        validUntil: getValidityString()
      };

      state.passes.unshift(pass);
      state.lastCreatedPass = pass;
      showConfirmation(pass);
    }

    function showConfirmation(pass) {
      elements.confirmationPassNumber.textContent = pass.id;
      
      elements.confirmationDetails.innerHTML = `
        <div class="detail-row">
          <div class="detail-label">–ü—Ä–∏—á–∏–Ω–∞:</div>
          <div class="detail-value">${pass.reason}</div>
        </div>
        <div class="detail-row">
          <div class="detail-label">–¢–∏–ø:</div>
          <div class="detail-value">${pass.vehicleType}</div>
        </div>
        <div class="detail-row">
          <div class="detail-label">–ü–µ—Ä–∏–æ–¥ –¥–µ–π—Å—Ç–≤–∏—è:</div>
          <div class="detail-value">${pass.validUntil}</div>
        </div>
        <div class="detail-row">
          <div class="detail-label">${pass.vehicleType === '–ü–µ—à–µ—Ö–æ–¥' ? '–§–ò–û' : '–ù–æ–º–µ—Ä'}:</div>
          <div class="detail-value">${pass.identifier}</div>
        </div>
      `;

      elements.orderForm.style.display = 'none';
      elements.confirmationScreen.style.display = 'block';
      state.showingConfirmation = true;
    }

    function resetForm() {
      state.selectedReason = null;
      state.selectedVehicle = null;
      state.selectedValidity = null;
      state.inputValue = '';
      state.showingConfirmation = false;

      elements.optionButtons.forEach(btn => btn.classList.remove('selected'));
      elements.identifierInput.value = '';
      elements.inputError.textContent = '';
      elements.identifierInput.classList.remove('error');
      elements.validityInfo.textContent = '';
      elements.submitButton.disabled = true;

      elements.orderForm.style.display = 'block';
      elements.confirmationScreen.style.display = 'none';
    }

    function renderArchive() {
      if (state.passes.length === 0) {
        elements.archiveEmpty.style.display = 'block';
        elements.archiveList.style.display = 'none';
        return;
      }

      elements.archiveEmpty.style.display = 'none';
      elements.archiveList.style.display = 'flex';

      elements.archiveList.innerHTML = state.passes.map((pass, index) => `
        <div class="archive-item">
          <div class="archive-item-header">
            <div class="archive-pass-number">${pass.id}</div>
            <button class="delete-button" data-index="${index}">üóëÔ∏è</button>
          </div>
          <div class="archive-item-details">
            <div class="archive-detail">
              <span class="archive-detail-label">–ü—Ä–∏—á–∏–Ω–∞</span>
              <span class="archive-detail-value">${pass.reason}</span>
            </div>
            <div class="archive-detail">
              <span class="archive-detail-label">–¢–∏–ø</span>
              <span class="archive-detail-value">${pass.vehicleType}</span>
            </div>
            <div class="archive-detail">
              <span class="archive-detail-label">–ü–µ—Ä–∏–æ–¥ –¥–µ–π—Å—Ç–≤–∏—è</span>
              <span class="archive-detail-value">${pass.validUntil}</span>
            </div>
            <div class="archive-detail">
              <span class="archive-detail-label">${pass.vehicleType === '–ü–µ—à–µ—Ö–æ–¥' ? '–§–ò–û' : '–ù–æ–º–µ—Ä'}</span>
              <span class="archive-detail-value">${pass.identifier}</span>
            </div>
          </div>
        </div>
      `).join('');

      // Attach delete handlers
      document.querySelectorAll('.delete-button').forEach(btn => {
        btn.addEventListener('click', (e) => {
          const index = parseInt(e.currentTarget.dataset.index);
          deletePass(index);
        });
      });
    }

    function deletePass(index) {
      state.passes.splice(index, 1);
      renderArchive();
    }

    function switchView(viewName) {
      state.currentView = viewName;

      // Update tabs
      elements.tabs.forEach(tab => {
        if (tab.dataset.view === viewName) {
          tab.classList.add('active');
        } else {
          tab.classList.remove('active');
        }
      });

      // Update views
      if (viewName === 'order') {
        elements.orderView.classList.add('active');
        elements.archiveView.classList.remove('active');
      } else {
        elements.orderView.classList.remove('active');
        elements.archiveView.classList.add('active');
        renderArchive();
      }
    }

    // Event Listeners
    elements.tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        switchView(tab.dataset.view);
      });
    });

    elements.optionButtons.forEach(button => {
      button.addEventListener('click', () => {
        const type = button.dataset.type;
        const value = button.dataset.value;

        // Deselect all buttons of the same type
        elements.optionButtons.forEach(btn => {
          if (btn.dataset.type === type) {
            btn.classList.remove('selected');
          }
        });

        // Select clicked button
        button.classList.add('selected');

        // Update state
        if (type === 'reason') {
          state.selectedReason = value;
        } else if (type === 'vehicle') {
          state.selectedVehicle = value;
          updateInputField();
        } else if (type === 'validity') {
          state.selectedValidity = value;
          updateValidityInfo();
        }

        validateForm();
      });
    });

    elements.identifierInput.addEventListener('input', (e) => {
      state.inputValue = e.target.value;
      validateForm();
    });

    elements.submitButton.addEventListener('click', () => {
      createPass();
    });

    elements.newPassButton.addEventListener('click', () => {
      resetForm();
    });

    elements.toArchiveButton.addEventListener('click', () => {
      resetForm();
      switchView('archive');
    });

    // Initialize
    validateForm();
  </script>
</body>
</html>